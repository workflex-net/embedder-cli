// Category: lib/firebase
// Modules: 13
// Total size: 82,138 chars


// === Module: wj (offset: 0x25e, 3,434 chars) ===
var wj=z(()=>{NYA={name:"embedder-cli-v3",version:vD,module:"src/index.tsx",type:"module",private:!0,scripts:{"download-grammars":"bun run scripts/download-grammars.ts",prepare:"bun run download-grammars && git config core.hooksPath .husky",dev:"bun run --watch src/index.tsx",fmt:"biome format --write",format:"biome format --write src/",lint:"biome lint --write && tsc --noEmit",check:"biome check --error-on-warnings && tsc --noEmit",test:"bun test","test:watch":"bun test --watch","test:coverage":"bun test --coverage","build:serial":`cd native/serial-ffi && cargo build --release && cd ../.. && node -e "require('fs').mkdirSync('bin',{recursive:true});require('fs').copyFileSync('native/serial-ffi/target/release/'+(process.platform==='win32'?'serial_ffi.dll':'libserial_ffi.'+(process.platform==='darwin'?'dylib':'so')),'bin/'+(process.platform==='win32'?'serial_ffi.dll':'libserial_ffi.'+(process.platform==='darwin'?'dylib':'so')))"`,"embed:serial":"bun run scripts/embed-serial-lib.ts","embed:assets":"bun run scripts/embed-assets.ts",embed:"bun run embed:serial && bun run embed:assets",compile:"bun run embed && bun run scripts/build.ts","compile:win":"BUN_TARGET=bun-windows-x64 bun run embed && bun run scripts/build.ts --target=bun-windows-x64","compile:mac":"BUN_TARGET=bun-darwin-x64 bun run embed && bun run scripts/build.ts --target=bun-darwin-x64","compile:mac-arm":"BUN_TARGET=bun-darwin-arm64 bun run embed && bun run scripts/build.ts --target=bun-darwin-arm64","compile:linux":"BUN_TARGET=bun-linux-x64 bun run embed && bun run scripts/build.ts --target=bun-linux-x64","install:local":"bun run scripts/install-local.ts","install:local-windows":"bun run scripts/install-local-windows.ts",bump:"bun run scripts/bump-version.ts"},devDependencies:{"@biomejs/biome":"2.3.11","@types/bun":"latest","@types/react":"^19.2.11","@types/semver":"^7.7.1","@types/which":"^3.0.4"},peerDependencies:{typescript:"^5.9.2"},optionalDependencies:{"@opentui/core-darwin-arm64":"^0.1.77","@opentui/core-darwin-x64":"^0.1.77","@opentui/core-linux-x64":"^0.1.77","@opentui/core-win32-x64":"^0.1.77"},dependencies:{"@ai-sdk/anthropic":"2.0.17","@ai-sdk/google":"2.0.14","@ai-sdk/openai":"2.0.32","@opentui/core":"^0.1.77","@opentui/react":"^0.1.77","@sentry/bun":"^10.38.0","@sentry/node":"^10.38.0",ai:"5.0.46",clipboardy:"^5.2.1","extract-zip":"^2.0.1",firebase:"^12.8.0",glob:"^11.1.0","lorem-ipsum":"^2.0.8",meow:"^14.0.0",open:"^11.0.0","opentui-spinner":"^0.0.6",react:"^19.2.4",semver:"^7.7.3","vscode-jsonrpc":"^8.2.1","vscode-languageserver-types":"^3.17.5","web-tree-sitter":"0.25.10",which:"^5.0.0",winston:"^3.19.0","winston-transport":"^4.9.0",zod:"^4.3.6",zustand:"^5.0.11"}}});var yYA="/$bunfs/root/highlights-ghv9g403.scm";var TYA=()=>{};var ZYA="/$bunfs/root/tree-sitter-javascript-nd0q4pe9.wasm";var VYA=()=>{};var WYA="/$bunfs/root/highlights-eq9cgrbb.scm";var qYA=()=>{};var jYA="/$bunfs/root/tree-sitter-typescript-zxjzwt75.wasm";var zYA=()=>{};var iYA="/$bunfs/root/highlights-r812a2qc.scm";var vYA=()=>{};var bYA="/$bunfs/root/tree-sitter-markdown-411r6y9b.wasm";var sYA=()=>{};var _YA="/$bunfs/root/injections-73j83es3.scm";var dYA=()=>{};var uYA="/$bunfs/root/highlights-x6tmsnaa.scm";var tYA=()=>{};var lYA="/$bunfs/root/tree-sitter-markdown_inline-j5349f42.wasm";var aYA=()=>{};var mYA="/$bunfs/root/highlights-hk7bwhj4.scm";var $YA=()=>{};var pYA="/$bunfs/root/tree-sitter-zig-e78zbjpm.wasm";var nYA=()=>{};

// === Module: cBB (offset: 0x1dab9e, 2,824 chars) ===
var cBB=z(()=>{CQ();tg();xBB();fBB=cQ(Xv,(A)=>new AQA(A)),BQA=VB(fhQ)});import*as oBB from"net";function hBB(A,B,Q,E,g){let I=()=>{},w=g.firestoreSpanCreationHook;if(typeof w==="function")I=(L)=>{DJ.safeExecuteInTheMiddle(()=>w(L),(R)=>{if(!R)return;wJ.diag.error(R?.message)},!0)};let D=new DJ.InstrumentationNodeModuleDefinition("@firebase/firestore",B,(L)=>kBB(L,Q,E,A,I)),H=["@firebase/firestore/dist/lite/index.node.cjs.js","@firebase/firestore/dist/lite/index.node.mjs.js","@firebase/firestore/dist/lite/index.rn.esm2017.js","@firebase/firestore/dist/lite/index.cjs.js"];for(let L of H)D.files.push(new DJ.InstrumentationNodeModuleFile(L,B,(R)=>kBB(R,Q,E,A,I),(R)=>XBB(R,E)));return D}function kBB(A,B,Q,E,g){return XBB(A,Q),B(A,"addDoc",chQ(E,g)),B(A,"getDocs",ohQ(E,g)),B(A,"setDoc",hhQ(E,g)),B(A,"deleteDoc",khQ(E,g)),A}function XBB(A,B){for(let Q of["addDoc","getDocs","setDoc","deleteDoc"])if(DJ.isWrapped(A[Q]))B(A,Q);return A}function chQ(A,B){return function(E){return function(g,C){let I=J5(A,"addDoc",g);return B(I),Y5(I,()=>{return E(g,C)})}}}function khQ(A,B){return function(E){return function(g){let C=J5(A,"deleteDoc",g.parent||g);return B(C),Y5(C,()=>{return E(g)})}}}function ohQ(A,B){return function(E){return function(g){let C=J5(A,"getDocs",g);return B(C),Y5(C,()=>{return E(g)})}}}function hhQ(A,B){return function(E){return function(g,C,I){let w=J5(A,"setDoc",g.parent||g);return B(w),Y5(w,()=>{return typeof I<"u"?E(g,C,I):E(g,C)})}}}function Y5(A,B){return wJ.context.with(wJ.trace.setSpan(wJ.context.active(),A),()=>{return DJ.safeExecuteInTheMiddle(()=>{return B()},(Q)=>{if(Q)A.recordException(Q);A.end()},!0)})}function J5(A,B,Q){let E=A.startSpan(`${B} ${Q.path}`,{kind:wJ.SpanKind.CLIENT});return PhQ(E,Q),E.setAttribute(PU.ATTR_DB_OPERATION_NAME,B),E}function XhQ(A){let B,Q;if(typeof A.host==="string")if(A.host.startsWith("[")){if(A.host.endsWith("]"))B=A.host.replace(/^\[|\]$/g,"");else if(A.host.includes("]:")){let E=A.host.lastIndexOf(":");if(E!==-1)B=A.host.slice(1,E).replace(/^\[|\]$/g,""),Q=A.host.slice(E+1)}}else if(oBB.isIPv6(A.host))B=A.host;else{let E=A.host.lastIndexOf(":");if(E!==-1)B=A.host.slice(0,E),Q=A.host.slice(E+1);else B=A.host}return{address:B,port:Q?parseInt(Q,10):void 0}}function PhQ(A,B){let Q=B.firestore.app,E=Q.options,C=(B.firestore.toJSON()||{}).settings||{},I={[PU.ATTR_DB_COLLECTION_NAME]:B.path,[PU.ATTR_DB_NAMESPACE]:Q.name,[PU.ATTR_DB_SYSTEM_NAME]:"firebase.firestore","firebase.firestore.type":B.type,"firebase.firestore.options.projectId":E.projectId,"firebase.firestore.options.appId":E.appId,"firebase.firestore.options.messagingSenderId":E.messagingSenderId,"firebase.firestore.options.storageBucket":E.storageBucket},{address:w,port:D}=XhQ(C);if(w)I[PU.ATTR_SERVER_ADDRESS]=w;if(D)I[PU.ATTR_SERVER_PORT]=D;A.setAttributes(I)}var wJ,DJ,PU;

// === Module: ZBB (offset: 0x1dc424, 497 chars) ===
var ZBB=z(()=>{CQ();PBB();TBB();VBB=iA(XE(),1),yBB={},NhQ=[">=3.0.0 <5"],ThQ=[">=6.0.0 <7"];QQA=class QQA extends VBB.InstrumentationBase{constructor(A=yBB){super("@sentry/instrumentation-firebase",Rg,A)}setConfig(A={}){super.setConfig({...yBB,...A})}init(){let A=[];return A.push(hBB(this.tracer,NhQ,this._wrap,this._unwrap,this.getConfig())),A.push(OBB(this.tracer,ThQ,this._wrap,this._unwrap,this.getConfig())),A}}});var qBB="Firebase",yhQ,WBB,VhQ=()=>{return{name:qBB,setupOnce(){WBB()}}},EQA;

// === Module: zBB (offset: 0x1dc615, 570 chars) ===
var zBB=z(()=>{CQ();tg();ZBB();yhQ={firestoreSpanCreationHook:(A)=>{PC(A,"auto.firebase.otel.firestore"),A.setAttribute(KE,"db.query")},functions:{requestHook:(A)=>{PC(A,"auto.firebase.otel.functions"),A.setAttribute(KE,"http.request")},errorHook:async(A,B)=>{if(B)jQ(B,{mechanism:{type:"auto.firebase.otel.functions",handled:!1}}),await sZ(2000)}}},WBB=cQ(qBB,()=>new QQA(yhQ)),EQA=VB(VhQ)});function AP(){return[xe(),Te(),ve(),xBA(),le(),ee(),EAA(),OAA(),zAA(),_AA(),LBA(),YBA(),oBA(),TBA(),qBA(),jBA(),se(),_BA(),de(),eBA(),BQA(),uBA(),lBA(),mBA(),pBA(),uAA(),EQA()]}

// === Module: HFB (offset: 0x279538, 698 chars) ===
var HFB=z(()=>{rC();DFB=S.enum(["prod","staging","infineon","test"]),MFB={prod:{apiUrl:"https://backend-service-prod.embedder.dev",webUrl:"https://app.embedder.dev",firebaseAuthDomain:"app.embedder.dev",analytics:!0},staging:{apiUrl:"https://backend-service-stage.embedder.dev",webUrl:"https://app-stage.embedder.dev",firebaseAuthDomain:"app-stage.embedder.dev",analytics:!0},infineon:{apiUrl:"https://infineon-backend-service-prod.embedder.com",webUrl:"https://infineon.embedder.com",firebaseAuthDomain:"infineon.embedder.com",analytics:!1},test:{apiUrl:"http://localhost:3000",webUrl:"http://localhost:3001",firebaseAuthDomain:"localhost",analytics:!0}}});var AzQ,BzQ="prod",QzQ,FFB,LFB,vb,w4,D4;

// === Module: VGB (offset: 0xb63521, 7,712 chars) ===
var VGB=z(()=>{uFA();uFA();esQ=["get","getKey","getAll","getAllKeys","count"],AbQ=["put","add","delete","clear"],aFA=new Map;NGB((A)=>({...A,get:(B,Q,E)=>TGB(B,Q)||A.get(B,Q,E),has:(B,Q)=>!!TGB(B,Q)||A.has(B,Q)}))});class vGB{constructor(A){this.container=A}getPlatformInfoString(){return this.container.getProviders().map((B)=>{if(BbQ(B)){let Q=B.getImmediate();return`${Q.library}/${Q.version}`}else return null}).filter((B)=>B).join(" ")}}function BbQ(A){return A.getComponent()?.type==="VERSION"}function qGB(A,B){try{A.container.addComponent(B)}catch(Q){XJ.debug(`Component ${B.name} failed to register with FirebaseApp ${A.name}`,Q)}}function UO(A){let B=A.name;if(nFA.has(B))return XJ.debug(`There were multiple attempts to register component ${B}.`),!1;nFA.set(B,A);for(let Q of Ld.values())qGB(Q,A);for(let Q of TbQ.values())qGB(Q,A);return!0}function pFA(A,B){let Q=A.container.getProvider("heartbeat").getImmediate({optional:!0});if(Q)Q.triggerHeartbeat();return A.container.getProvider(B)}function PJ(A){if(A===null||A===void 0)return!1;return A.settings!==void 0}class iGB{constructor(A,B,Q){this._isDeleted=!1,this._options={...A},this._config={...B},this._name=B.name,this._automaticDataCollectionEnabled=B.automaticDataCollectionEnabled,this._container=Q,this.container.addComponent(new hJ("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(A){this.checkDestroyed(),this._automaticDataCollectionEnabled=A}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(A){this._isDeleted=A}checkDestroyed(){if(this.isDeleted)throw Yx.create("app-deleted",{appName:this._name})}}function rFA(A,B={}){let Q=A;if(typeof B!=="object")B={name:B};let E={name:mFA,automaticDataCollectionEnabled:!0,...B},g=E.name;if(typeof g!=="string"||!g)throw Yx.create("bad-app-name",{appName:String(g)});if(Q||(Q=vFA()),!Q)throw Yx.create("no-options");let C=Ld.get(g);if(C)if(Kx(Q,C.options)&&Kx(E,C.config))return C;else throw Yx.create("duplicate-app",{appName:g});let I=new sFA(g);for(let D of nFA.values())I.addComponent(D);let w=new iGB(Q,E,I);return Ld.set(g,w),w}function sGB(A=mFA){let B=Ld.get(A);if(!B&&A===mFA&&vFA())return rFA();if(!B)throw Yx.create("no-app",{appName:A});return B}function Jx(A,B,Q){let E=NbQ[A]??A;if(Q)E+=`-${Q}`;let g=E.match(/\s|\//),C=B.match(/\s|\//);if(g||C){let I=[`Unable to register library "${E}" with version "${B}":`];if(g)I.push(`library name "${E}" contains illegal characters (whitespace or "/")`);if(g&&C)I.push("and");if(C)I.push(`version name "${B}" contains illegal characters (whitespace or "/")`);XJ.warn(I.join(" "));return}UO(new hJ(`${E}-version`,()=>({library:E,version:B}),"VERSION"))}function bGB(){if(!lFA)lFA=yGB(VbQ,ZbQ,{upgrade:(A,B)=>{switch(B){case 0:try{A.createObjectStore(c9)}catch(Q){console.warn(Q)}}}}).catch((A)=>{throw Yx.create("idb-open",{originalErrorMessage:A.message})});return lFA}async function qbQ(A){try{let Q=(await bGB()).transaction(c9),E=await Q.objectStore(c9).get(dGB(A));return await Q.done,E}catch(B){if(B instanceof bR)XJ.warn(B.message);else{let Q=Yx.create("idb-get",{originalErrorMessage:B?.message});XJ.warn(Q.message)}}}async function WGB(A,B){try{let E=(await bGB()).transaction(c9,"readwrite");await E.objectStore(c9).put(B,dGB(A)),await E.done}catch(Q){if(Q instanceof bR)XJ.warn(Q.message);else{let E=Yx.create("idb-set",{originalErrorMessage:Q?.message});XJ.warn(E.message)}}}function dGB(A){return`${A.name}!${A.options.appId}`}class _GB{constructor(A){this.container=A,this._heartbeatsCache=null;let B=this.container.getProvider("app").getImmediate();this._storage=new tGB(B),this._heartbeatsCachePromise=this._storage.read().then((Q)=>{return this._heartbeatsCache=Q,Q})}async triggerHeartbeat(){try{let B=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Q=zGB();if(this._heartbeatsCache?.heartbeats==null){if(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)return}if(this._heartbeatsCache.lastSentHeartbeatDate===Q||this._heartbeatsCache.heartbeats.some((E)=>E.date===Q))return;else if(this._heartbeatsCache.heartbeats.push({date:Q,agent:B}),this._heartbeatsCache.heartbeats.length>zbQ){let E=vbQ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(E,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(A){XJ.warn(A)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null)await this._heartbeatsCachePromise;if(this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let A=zGB(),{heartbeatsToSend:B,unsentEntries:Q}=jbQ(this._heartbeatsCache.heartbeats),E=jFA(JSON.stringify({version:2,heartbeats:B}));if(this._heartbeatsCache.lastSentHeartbeatDate=A,Q.length>0)this._heartbeatsCache.heartbeats=Q,await this._storage.overwrite(this._heartbeatsCache);else this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);return E}catch(A){return XJ.warn(A),""}}}function zGB(){return new Date().toISOString().substring(0,10)}function jbQ(A,B=WbQ){let Q=[],E=A.slice();for(let g of A){let C=Q.find((I)=>I.agent===g.agent);if(!C){if(Q.push({agent:g.agent,dates:[g.date]}),jGB(Q)>B){Q.pop();break}}else if(C.dates.push(g.date),jGB(Q)>B){C.dates.pop();break}E=E.slice(1)}return{heartbeatsToSend:Q,unsentEntries:E}}class tGB{constructor(A){this.app=A,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){if(!xGB())return!1;else return fGB().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};else{let B=await qbQ(this.app);if(B?.heartbeats)return B;else return{heartbeats:[]}}}async overwrite(A){if(!await this._canUseIndexedDBPromise)return;else{let Q=await this.read();return WGB(this.app,{lastSentHeartbeatDate:A.lastSentHeartbeatDate??Q.lastSentHeartbeatDate,heartbeats:A.heartbeats})}}async add(A){if(!await this._canUseIndexedDBPromise)return;else{let Q=await this.read();return WGB(this.app,{lastSentHeartbeatDate:A.lastSentHeartbeatDate??Q.lastSentHeartbeatDate,heartbeats:[...Q.heartbeats,...A.heartbeats]})}}}function jGB(A){return jFA(JSON.stringify({version:2,heartbeats:A})).length}function vbQ(A){if(A.length===0)return-1;let B=0,Q=A[0].date;for(let E=1;E<A.length;E++)if(A[E].date<Q)Q=A[E].date,B=E;return B}function ibQ(A){UO(new hJ("platform-logger",(B)=>new vGB(B),"PRIVATE")),UO(new hJ("heartbeat",(B)=>new _GB(B),"PRIVATE")),Jx($FA,ZGB,A),Jx($FA,ZGB,"esm2020"),Jx("fire-js","")}var $FA="@firebase/app",ZGB="0.14.7",XJ,QbQ="@firebase/app-compat",EbQ="@firebase/analytics-compat",gbQ="@firebase/analytics",CbQ="@firebase/app-check-compat",IbQ="@firebase/app-check",wbQ="@firebase/auth",DbQ="@firebase/auth-compat",MbQ="@firebase/database",HbQ="@firebase/data-connect",FbQ="@firebase/database-compat",LbQ="@firebase/functions",UbQ="@firebase/functions-compat",GbQ="@firebase/installations",RbQ="@firebase/installations-compat",KbQ="@firebase/messaging",YbQ="@firebase/messaging-compat",JbQ="@firebase/performance",SbQ="@firebase/performance-compat",xbQ="@firebase/remote-config",fbQ="@firebase/remote-config-compat",cbQ="@firebase/storage",kbQ="@firebase/storage-compat",obQ="@firebase/firestore",hbQ="@firebase/ai",XbQ="@firebase/firestore-compat",PbQ="firebase",ObQ="12.8.0",mFA="[DEFAULT]",NbQ,Ld,TbQ,nFA,ybQ,Yx,k9,VbQ="firebase-heartbeat-database",ZbQ=1,c9="firebase-heartbeat-store",lFA=null,WbQ=1024,zbQ=30;

// === Module: GO (offset: 0xb65341, 48,190 chars) ===
var GO=z(()=>{S9();f9();Y4();Y4();VGB();XJ=new x9("@firebase/app"),NbQ={[$FA]:"fire-core",[QbQ]:"fire-core-compat",[gbQ]:"fire-analytics",[EbQ]:"fire-analytics-compat",[IbQ]:"fire-app-check",[CbQ]:"fire-app-check-compat",[wbQ]:"fire-auth",[DbQ]:"fire-auth-compat",[MbQ]:"fire-rtdb",[HbQ]:"fire-data-connect",[FbQ]:"fire-rtdb-compat",[LbQ]:"fire-fn",[UbQ]:"fire-fn-compat",[GbQ]:"fire-iid",[RbQ]:"fire-iid-compat",[KbQ]:"fire-fcm",[YbQ]:"fire-fcm-compat",[JbQ]:"fire-perf",[SbQ]:"fire-perf-compat",[xbQ]:"fire-rc",[fbQ]:"fire-rc-compat",[cbQ]:"fire-gcs",[kbQ]:"fire-gcs-compat",[obQ]:"fire-fst",[XbQ]:"fire-fst-compat",[hbQ]:"fire-vertex","fire-js":"fire-js",[PbQ]:"fire-js-all"},Ld=new Map,TbQ=new Map,nFA=new Map;ybQ={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}'",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["server-app-deleted"]:"Firebase Server App has been deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.",["finalization-registry-not-supported"]:"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.",["invalid-server-app-environment"]:"FirebaseServerApp is not for use in browser environments."},Yx=new Rx("app","Firebase",ybQ);k9=ObQ;ibQ("")});function BRB(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}function sbQ(A,...B){if(Yd.logLevel<=iC.WARN)Yd.warn(`Auth (${k9}): ${A}`,...B)}function Rd(A,...B){if(Yd.logLevel<=iC.ERROR)Yd.error(`Auth (${k9}): ${A}`,...B)}function NJ(A,...B){throw ELA(A,...B)}function kd(A,...B){return ELA(A,...B)}function ERB(A,B,Q){let E={...QLA(),[B]:Q};return new Rx("auth","Firebase",E).create(B,{appName:A.name})}function RO(A){return ERB(A,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ELA(A,...B){if(typeof A!=="string"){let Q=B[0],E=[...B.slice(1)];if(E[0])E[0].appName=A.name;return A._errorFactory.create(Q,...E)}return QRB.create(A,...B)}function Ig(A,B,...Q){if(!A)throw ELA(B,...Q)}function lR(A){let B="INTERNAL ASSERTION FAILED: "+A;throw Rd(B),Error(B)}function P9(A,B){if(!A)lR(B)}function bbQ(){return uGB()==="http:"||uGB()==="https:"}function uGB(){return typeof self<"u"&&self.location?.protocol||null}function dbQ(){if(typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine==="boolean"&&(bbQ()||YGB()||("connection"in navigator)))return navigator.onLine;return!0}function _bQ(){if(typeof navigator>"u")return null;let A=navigator;return A.languages&&A.languages[0]||A.language||null}class gRB{constructor(A,B){this.shortDelay=A,this.longDelay=B,P9(B>A,"Short delay should be less than long delay!"),this.isMobile=RGB()||JGB()}get(){if(!dbQ())return Math.min(5000,this.shortDelay);return this.isMobile?this.longDelay:this.shortDelay}}function CRB(A,B){P9(A.emulator,"Emulator should always be set here");let{url:Q}=A.emulator;if(!B)return Q;return`${Q}${B.startsWith("/")?B.slice(1):B}`}class N9{static initialize(A,B,Q){if(this.fetchImpl=A,B)this.headersImpl=B;if(Q)this.responseImpl=Q}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;lR("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;lR("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;lR("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}function EG(A,B){if(A.tenantId&&!B.tenantId)return{...B,tenantId:A.tenantId};return B}async function gG(A,B,Q,E,g={}){return IRB(A,g,async()=>{let C={},I={};if(E)if(B==="GET")I=E;else C={body:JSON.stringify(E)};let w=J9({key:A.config.apiKey,...I}).slice(1),D=await A._getAdditionalHeaders();if(D["Content-Type"]="application/json",A.languageCode)D["X-Firebase-Locale"]=A.languageCode;let H={method:B,headers:D,...C};if(!KGB())H.referrerPolicy="no-referrer";if(A.emulatorConfig&&Y9(A.emulatorConfig.host))H.credentials="include";return N9.fetch()(await wRB(A,A.config.apiHost,Q,w),H)})}async function IRB(A,B,Q){A._canInitEmulator=!1;let E={...tbQ,...B};try{let g=new DRB(A),C=await Promise.race([Q(),g.promise]);g.clearNetworkTimeout();let I=await C.json();if("needConfirmation"in I)throw Ud(A,"account-exists-with-different-credential",I);if(C.ok&&!("errorMessage"in I))return I;else{let w=C.ok?I.errorMessage:I.error.message,[D,H]=w.split(" : ");if(D==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ud(A,"credential-already-in-use",I);else if(D==="EMAIL_EXISTS")throw Ud(A,"email-already-in-use",I);else if(D==="USER_DISABLED")throw Ud(A,"user-disabled",I);let L=E[D]||D.toLowerCase().replace(/[_\s]+/g,"-");if(H)throw ERB(A,L,H);else NJ(A,L)}}catch(g){if(g instanceof bR)throw g;NJ(A,"network-request-failed",{message:String(g)})}}async function T9(A,B,Q,E,g={}){let C=await gG(A,B,Q,E,g);if("mfaPendingCredential"in C)NJ(A,"multi-factor-auth-required",{_serverResponse:C});return C}async function wRB(A,B,Q,E){let g=`${B}${Q}?${E}`,C=A,I=C.config.emulator?CRB(A.config,g):`${A.config.apiScheme}://${g}`;if(ubQ.includes(Q)){if(await C._persistenceManagerAvailable,C._getPersistenceType()==="COOKIE")return C._getPersistence()._getFinalTarget(I).toString()}return I}function lbQ(A){switch(A){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class DRB{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(A){this.auth=A,this.timer=null,this.promise=new Promise((B,Q)=>{this.timer=setTimeout(()=>{return Q(kd(this.auth,"network-request-failed"))},abQ.get())})}}function Ud(A,B,Q){let E={appName:A.name};if(Q.email)E.email=Q.email;if(Q.phoneNumber)E.phoneNumber=Q.phoneNumber;let g=kd(A,B,E);return g.customData._tokenResponse=Q,g}function aGB(A){return A!==void 0&&A.enterprise!==void 0}class MRB{constructor(A){if(this.siteKey="",this.recaptchaEnforcementState=[],A.recaptchaKey===void 0)throw Error("recaptchaKey undefined");this.siteKey=A.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=A.recaptchaEnforcementState}getProviderEnforcementState(A){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let B of this.recaptchaEnforcementState)if(B.provider&&B.provider===A)return lbQ(B.enforcementState);return null}isProviderEnabled(A){return this.getProviderEnforcementState(A)==="ENFORCE"||this.getProviderEnforcementState(A)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function $bQ(A,B){return gG(A,"GET","/v2/recaptchaConfig",EG(A,B))}async function mbQ(A,B){return gG(A,"POST","/v1/accounts:delete",B)}async function Jd(A,B){return gG(A,"POST","/v1/accounts:lookup",B)}function h9(A){if(!A)return;try{let B=new Date(Number(A));if(!isNaN(B.getTime()))return B.toUTCString()}catch(B){}return}async function gLA(A,B=!1){let Q=K4(A),E=await Q.getIdToken(B),g=HRB(E);Ig(g&&g.exp&&g.auth_time&&g.iat,Q.auth,"internal-error");let C=typeof g.firebase==="object"?g.firebase:void 0,I=C?.sign_in_provider;return{claims:g,token:E,authTime:h9(eFA(g.auth_time)),issuedAtTime:h9(eFA(g.iat)),expirationTime:h9(eFA(g.exp)),signInProvider:I||null,signInSecondFactor:C?.sign_in_second_factor||null}}function eFA(A){return Number(A)*1000}function HRB(A){let[B,Q,E]=A.split(".");if(B===void 0||Q===void 0||E===void 0)return Rd("JWT malformed, contained fewer than 3 sections"),null;try{let g=Hd(Q);if(!g)return Rd("Failed to decode base64 JWT payload"),null;return JSON.parse(g)}catch(g){return Rd("Caught error parsing JWT payload as JSON",g?.toString()),null}}function lGB(A){let B=HRB(A);return Ig(B,"internal-error"),Ig(typeof B.exp<"u","internal-error"),Ig(typeof B.iat<"u","internal-error"),Number(B.exp)-Number(B.iat)}async function ALA(A,B,Q=!1){if(Q)return B;try{return await B}catch(E){if(E instanceof bR&&nbQ(E)){if(A.auth.currentUser===A)await A.auth.signOut()}throw E}}function nbQ({code:A}){return A==="auth/user-disabled"||A==="auth/user-token-expired"}class FRB{constructor(A){this.user=A,this.isRunning=!1,this.timerId=null,this.errorBackoff=30000}_start(){if(this.isRunning)return;this.isRunning=!0,this.schedule()}_stop(){if(!this.isRunning)return;if(this.isRunning=!1,this.timerId!==null)clearTimeout(this.timerId)}getInterval(A){if(A){let B=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,960000),B}else{this.errorBackoff=30000;let Q=(this.user.stsTokenManager.expirationTime??0)-Date.now()-300000;return Math.max(0,Q)}}schedule(A=!1){if(!this.isRunning)return;let B=this.getInterval(A);this.timerId=setTimeout(async()=>{await this.iteration()},B)}async iteration(){try{await this.user.getIdToken(!0)}catch(A){if(A?.code==="auth/network-request-failed")this.schedule(!0);return}this.schedule()}}class Sd{constructor(A,B){this.createdAt=A,this.lastLoginAt=B,this._initializeTime()}_initializeTime(){this.lastSignInTime=h9(this.lastLoginAt),this.creationTime=h9(this.createdAt)}_copy(A){this.createdAt=A.createdAt,this.lastLoginAt=A.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function xd(A){let B=A.auth,Q=await A.getIdToken(),E=await ALA(A,Jd(B,{idToken:Q}));Ig(E?.users.length,B,"internal-error");let g=E.users[0];A._notifyReloadListener(g);let C=g.providerUserInfo?.length?LRB(g.providerUserInfo):[],I=pbQ(A.providerData,C),w=A.isAnonymous,D=!(A.email&&g.passwordHash)&&!I?.length,H=!w?!1:D,L={uid:g.localId,displayName:g.displayName||null,photoURL:g.photoUrl||null,email:g.email||null,emailVerified:g.emailVerified||!1,phoneNumber:g.phoneNumber||null,tenantId:g.tenantId||null,providerData:I,metadata:new Sd(g.createdAt,g.lastLoginAt),isAnonymous:H};Object.assign(A,L)}async function CLA(A){let B=K4(A);await xd(B),await B.auth._persistUserIfCurrent(B),B.auth._notifyListenersIfCurrent(B)}function pbQ(A,B){return[...A.filter((E)=>!B.some((g)=>g.providerId===E.providerId)),...B]}function LRB(A){return A.map(({providerId:B,...Q})=>{return{providerId:B,uid:Q.rawId||"",displayName:Q.displayName||null,email:Q.email||null,phoneNumber:Q.phoneNumber||null,photoURL:Q.photoUrl||null}})}async function rbQ(A,B){let Q=await IRB(A,{},async()=>{let E=J9({grant_type:"refresh_token",refresh_token:B}).slice(1),{tokenApiHost:g,apiKey:C}=A.config,I=await wRB(A,g,"/v1/token",`key=${C}`),w=await A._getAdditionalHeaders();w["Content-Type"]="application/x-www-form-urlencoded";let D={method:"POST",headers:w,body:E};if(A.emulatorConfig&&Y9(A.emulatorConfig.host))D.credentials="include";return N9.fetch()(I,D)});return{accessToken:Q.access_token,expiresIn:Q.expires_in,refreshToken:Q.refresh_token}}async function ebQ(A,B){return gG(A,"POST","/v2/accounts:revokeToken",EG(A,B))}class KO{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-30000}updateFromServerResponse(A){Ig(A.idToken,"internal-error"),Ig(typeof A.idToken<"u","internal-error"),Ig(typeof A.refreshToken<"u","internal-error");let B="expiresIn"in A&&typeof A.expiresIn<"u"?Number(A.expiresIn):lGB(A.idToken);this.updateTokensAndExpiration(A.idToken,A.refreshToken,B)}updateFromIdToken(A){Ig(A.length!==0,"internal-error");let B=lGB(A);this.updateTokensAndExpiration(A,null,B)}async getToken(A,B=!1){if(!B&&this.accessToken&&!this.isExpired)return this.accessToken;if(Ig(this.refreshToken,A,"user-token-expired"),this.refreshToken)return await this.refresh(A,this.refreshToken),this.accessToken;return null}clearRefreshToken(){this.refreshToken=null}async refresh(A,B){let{accessToken:Q,refreshToken:E,expiresIn:g}=await rbQ(A,B);this.updateTokensAndExpiration(Q,E,Number(g))}updateTokensAndExpiration(A,B,Q){this.refreshToken=B||null,this.accessToken=A||null,this.expirationTime=Date.now()+Q*1000}static fromJSON(A,B){let{refreshToken:Q,accessToken:E,expirationTime:g}=B,C=new KO;if(Q)Ig(typeof Q==="string","internal-error",{appName:A}),C.refreshToken=Q;if(E)Ig(typeof E==="string","internal-error",{appName:A}),C.accessToken=E;if(g)Ig(typeof g==="number","internal-error",{appName:A}),C.expirationTime=g;return C}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(A){this.accessToken=A.accessToken,this.refreshToken=A.refreshToken,this.expirationTime=A.expirationTime}_clone(){return Object.assign(new KO,this.toJSON())}_performRefresh(){return lR("not implemented")}}function Sx(A,B){Ig(typeof A==="string"||typeof A>"u","internal-error",{appName:B})}class OF{constructor({uid:A,auth:B,stsTokenManager:Q,...E}){this.providerId="firebase",this.proactiveRefresh=new FRB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=A,this.auth=B,this.stsTokenManager=Q,this.accessToken=Q.accessToken,this.displayName=E.displayName||null,this.email=E.email||null,this.emailVerified=E.emailVerified||!1,this.phoneNumber=E.phoneNumber||null,this.photoURL=E.photoURL||null,this.isAnonymous=E.isAnonymous||!1,this.tenantId=E.tenantId||null,this.providerData=E.providerData?[...E.providerData]:[],this.metadata=new Sd(E.createdAt||void 0,E.lastLoginAt||void 0)}async getIdToken(A){let B=await ALA(this,this.stsTokenManager.getToken(this.auth,A));if(Ig(B,this.auth,"internal-error"),this.accessToken!==B)this.accessToken=B,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this);return B}getIdTokenResult(A){return gLA(this,A)}reload(){return CLA(this)}_assign(A){if(this===A)return;Ig(this.uid===A.uid,this.auth,"internal-error"),this.displayName=A.displayName,this.photoURL=A.photoURL,this.email=A.email,this.emailVerified=A.emailVerified,this.phoneNumber=A.phoneNumber,this.isAnonymous=A.isAnonymous,this.tenantId=A.tenantId,this.providerData=A.providerData.map((B)=>({...B})),this.metadata._copy(A.metadata),this.stsTokenManager._assign(A.stsTokenManager)}_clone(A){let B=new OF({...this,auth:A,stsTokenManager:this.stsTokenManager._clone()});return B.metadata._copy(this.metadata),B}_onReload(A){if(Ig(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=A,this.reloadUserInfo)this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null}_notifyReloadListener(A){if(this.reloadListener)this.reloadListener(A);else this.reloadUserInfo=A}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(A,B=!1){let Q=!1;if(A.idToken&&A.idToken!==this.stsTokenManager.accessToken)this.stsTokenManager.updateFromServerResponse(A),Q=!0;if(B)await xd(this);if(await this.auth._persistUserIfCurrent(this),Q)this.auth._notifyListenersIfCurrent(this)}async delete(){if(PJ(this.auth.app))return Promise.reject(RO(this.auth));let A=await this.getIdToken();return await ALA(this,mbQ(this.auth,{idToken:A})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((A)=>({...A})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(A,B){let Q=B.displayName??void 0,E=B.email??void 0,g=B.phoneNumber??void 0,C=B.photoURL??void 0,I=B.tenantId??void 0,w=B._redirectEventId??void 0,D=B.createdAt??void 0,H=B.lastLoginAt??void 0,{uid:L,emailVerified:R,isAnonymous:U,providerData:G,stsTokenManager:Y}=B;Ig(L&&Y,A,"internal-error");let J=KO.fromJSON(this.name,Y);Ig(typeof L==="string",A,"internal-error"),Sx(Q,A.name),Sx(E,A.name),Ig(typeof R==="boolean",A,"internal-error"),Ig(typeof U==="boolean",A,"internal-error"),Sx(g,A.name),Sx(C,A.name),Sx(I,A.name),Sx(w,A.name),Sx(D,A.name),Sx(H,A.name);let c=new OF({uid:L,auth:A,email:E,emailVerified:R,displayName:Q,isAnonymous:U,photoURL:C,phoneNumber:g,tenantId:I,stsTokenManager:J,createdAt:D,lastLoginAt:H});if(G&&Array.isArray(G))c.providerData=G.map((h)=>({...h}));if(w)c._redirectEventId=w;return c}static async _fromIdTokenResponse(A,B,Q=!1){let E=new KO;E.updateFromServerResponse(B);let g=new OF({uid:B.localId,auth:A,stsTokenManager:E,isAnonymous:Q});return await xd(g),g}static async _fromGetAccountInfoResponse(A,B,Q){let E=B.users[0];Ig(E.localId!==void 0,"internal-error");let g=E.providerUserInfo!==void 0?LRB(E.providerUserInfo):[],C=!(E.email&&E.passwordHash)&&!g?.length,I=new KO;I.updateFromIdToken(Q);let w=new OF({uid:E.localId,auth:A,stsTokenManager:I,isAnonymous:C}),D={uid:E.localId,displayName:E.displayName||null,photoURL:E.photoUrl||null,email:E.email||null,emailVerified:E.emailVerified||!1,phoneNumber:E.phoneNumber||null,tenantId:E.tenantId||null,providerData:g,metadata:new Sd(E.createdAt,E.lastLoginAt),isAnonymous:!(E.email&&E.passwordHash)&&!g?.length};return Object.assign(w,D),w}}function OJ(A){P9(A instanceof Function,"Expected a class definition");let B=$GB.get(A);if(B)return P9(B instanceof A,"Instance stored in cache mismatched with class"),B;return B=new A,$GB.set(A,B),B}class ILA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(A,B){this.storage[A]=B}async _get(A){let B=this.storage[A];return B===void 0?null:B}async _remove(A){delete this.storage[A]}_addListener(A,B){return}_removeListener(A,B){return}}function X9(A,B,Q){return`firebase:${A}:${B}:${Q}`}class YO{constructor(A,B,Q){this.persistence=A,this.auth=B,this.userKey=Q;let{config:E,name:g}=this.auth;this.fullUserKey=X9(this.userKey,E.apiKey,g),this.fullPersistenceKey=X9("persistence",E.apiKey,g),this.boundEventHandler=B._onStorageEvent.bind(B),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(A){return this.persistence._set(this.fullUserKey,A.toJSON())}async getCurrentUser(){let A=await this.persistence._get(this.fullUserKey);if(!A)return null;if(typeof A==="string"){let B=await Jd(this.auth,{idToken:A}).catch(()=>{return});if(!B)return null;return OF._fromGetAccountInfoResponse(this.auth,B,A)}return OF._fromJSON(this.auth,A)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(A){if(this.persistence===A)return;let B=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=A,B)return this.setCurrentUser(B)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(A,B,Q="authUser"){if(!B.length)return new YO(OJ(fd),A,Q);let E=(await Promise.all(B.map(async(D)=>{if(await D._isAvailable())return D;return}))).filter((D)=>D),g=E[0]||OJ(fd),C=X9(Q,A.config.apiKey,A.name),I=null;for(let D of B)try{let H=await D._get(C);if(H){let L;if(typeof H==="string"){let R=await Jd(A,{idToken:H}).catch(()=>{return});if(!R)break;L=await OF._fromGetAccountInfoResponse(A,R,H)}else L=OF._fromJSON(A,H);if(D!==g)I=L;g=D;break}}catch{}let w=E.filter((D)=>D._shouldAllowMigration);if(!g._shouldAllowMigration||!w.length)return new YO(g,A,Q);if(g=w[0],I)await g._set(C,I.toJSON());return await Promise.all(B.map(async(D)=>{if(D!==g)try{await D._remove(C)}catch{}})),new YO(g,A,Q)}}function mGB(A){let B=A.toLowerCase();if(B.includes("opera/")||B.includes("opr/")||B.includes("opios/"))return"Opera";else if(URB(B))return"IEMobile";else if(B.includes("msie")||B.includes("trident/"))return"IE";else if(B.includes("edge/"))return"Edge";else if(AdQ(B))return"Firefox";else if(B.includes("silk/"))return"Silk";else if(GRB(B))return"Blackberry";else if(RRB(B))return"Webos";else if(BdQ(B))return"Safari";else if((B.includes("chrome/")||QdQ(B))&&!B.includes("edge/"))return"Chrome";else if(wLA(B))return"Android";else{let Q=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,E=A.match(Q);if(E?.length===2)return E[1]}return"Other"}function AdQ(A=PF()){return/firefox\//i.test(A)}function BdQ(A=PF()){let B=A.toLowerCase();return B.includes("safari/")&&!B.includes("chrome/")&&!B.includes("crios/")&&!B.includes("android")}function QdQ(A=PF()){return/crios\//i.test(A)}function URB(A=PF()){return/iemobile/i.test(A)}function wLA(A=PF()){return/android/i.test(A)}function GRB(A=PF()){return/blackberry/i.test(A)}function RRB(A=PF()){return/webos/i.test(A)}function KRB(A=PF()){return/iphone|ipad|ipod/i.test(A)||/macintosh/i.test(A)&&/mobile/i.test(A)}function YRB(){return SGB()&&document.documentMode===10}function JRB(A=PF()){return KRB(A)||wLA(A)||RRB(A)||GRB(A)||/windows phone/i.test(A)||URB(A)}function DLA(A,B=[]){let Q;switch(A){case"Browser":Q=mGB(PF());break;case"Worker":Q=`${mGB(PF())}-${A}`;break;default:Q=A}let E=B.length?B.join(","):"FirebaseCore-web";return`${Q}/JsCore/${k9}/${E}`}class SRB{constructor(A){this.auth=A,this.queue=[]}pushCallback(A,B){let Q=(g)=>new Promise((C,I)=>{try{let w=A(g);C(w)}catch(w){I(w)}});Q.onAbort=B,this.queue.push(Q);let E=this.queue.length-1;return()=>{this.queue[E]=()=>Promise.resolve()}}async runMiddleware(A){if(this.auth.currentUser===A)return;let B=[];try{for(let Q of this.queue)if(await Q(A),Q.onAbort)B.push(Q.onAbort)}catch(Q){B.reverse();for(let E of B)try{E()}catch(g){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:Q?.message})}}}async function EdQ(A,B={}){return gG(A,"GET","/v2/passwordPolicy",EG(A,B))}class xRB{constructor(A){let B=A.customStrengthOptions;if(this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=B.minPasswordLength??gdQ,B.maxPasswordLength)this.customStrengthOptions.maxPasswordLength=B.maxPasswordLength;if(B.containsLowercaseCharacter!==void 0)this.customStrengthOptions.containsLowercaseLetter=B.containsLowercaseCharacter;if(B.containsUppercaseCharacter!==void 0)this.customStrengthOptions.containsUppercaseLetter=B.containsUppercaseCharacter;if(B.containsNumericCharacter!==void 0)this.customStrengthOptions.containsNumericCharacter=B.containsNumericCharacter;if(B.containsNonAlphanumericCharacter!==void 0)this.customStrengthOptions.containsNonAlphanumericCharacter=B.containsNonAlphanumericCharacter;if(this.enforcementState=A.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED")this.enforcementState="OFF";this.allowedNonAlphanumericCharacters=A.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=A.forceUpgradeOnSignin??!1,this.schemaVersion=A.schemaVersion}validatePassword(A){let B={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(A,B),this.validatePasswordCharacterOptions(A,B),B.isValid&&(B.isValid=B.meetsMinPasswordLength??!0),B.isValid&&(B.isValid=B.meetsMaxPasswordLength??!0),B.isValid&&(B.isValid=B.containsLowercaseLetter??!0),B.isValid&&(B.isValid=B.containsUppercaseLetter??!0),B.isValid&&(B.isValid=B.containsNumericCharacter??!0),B.isValid&&(B.isValid=B.containsNonAlphanumericCharacter??!0),B}validatePasswordLengthOptions(A,B){let Q=this.customStrengthOptions.minPasswordLength,E=this.customStrengthOptions.maxPasswordLength;if(Q)B.meetsMinPasswordLength=A.length>=Q;if(E)B.meetsMaxPasswordLength=A.length<=E}validatePasswordCharacterOptions(A,B){this.updatePasswordCharacterOptionsStatuses(B,!1,!1,!1,!1);let Q;for(let E=0;E<A.length;E++)Q=A.charAt(E),this.updatePasswordCharacterOptionsStatuses(B,Q>="a"&&Q<="z",Q>="A"&&Q<="Z",Q>="0"&&Q<="9",this.allowedNonAlphanumericCharacters.includes(Q))}updatePasswordCharacterOptionsStatuses(A,B,Q,E,g){if(this.customStrengthOptions.containsLowercaseLetter)A.containsLowercaseLetter||(A.containsLowercaseLetter=B);if(this.customStrengthOptions.containsUppercaseLetter)A.containsUppercaseLetter||(A.containsUppercaseLetter=Q);if(this.customStrengthOptions.containsNumericCharacter)A.containsNumericCharacter||(A.containsNumericCharacter=E);if(this.customStrengthOptions.containsNonAlphanumericCharacter)A.containsNonAlphanumericCharacter||(A.containsNonAlphanumericCharacter=g)}}class od{constructor(A,B,Q,E){this.app=A,this.heartbeatServiceProvider=B,this.appCheckServiceProvider=Q,this.config=E,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new BLA(this),this.idTokenSubscription=new BLA(this),this.beforeStateQueue=new SRB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=QRB,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=A.name,this.clientVersion=E.sdkClientVersion,this._persistenceManagerAvailable=new Promise((g)=>this._resolvePersistenceManagerAvailable=g)}_initializeWithPersistence(A,B){if(B)this._popupRedirectResolver=OJ(B);return this._initializationPromise=this.queue(async()=>{if(this._deleted)return;if(this.persistenceManager=await YO.create(this,A),this._resolvePersistenceManagerAvailable?.(),this._deleted)return;if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(Q){}if(await this.initializeCurrentUser(B),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted)return;this._isInitialized=!0}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let A=await this.assertedPersistence.getCurrentUser();if(!this.currentUser&&!A)return;if(this.currentUser&&A&&this.currentUser.uid===A.uid){this._currentUser._assign(A),await this.currentUser.getIdToken();return}await this._updateCurrentUser(A,!0)}async initializeCurrentUserFromIdToken(A){try{let B=await Jd(this,{idToken:A}),Q=await OF._fromGetAccountInfoResponse(this,B,A);await this.directlySetCurrentUser(Q)}catch(B){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",B),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(A){if(PJ(this.app)){let g=this.app.settings.authIdToken;if(g)return new Promise((C)=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(g).then(C,C))});else return this.directlySetCurrentUser(null)}let B=await this.assertedPersistence.getCurrentUser(),Q=B,E=!1;if(A&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let g=this.redirectUser?._redirectEventId,C=Q?._redirectEventId,I=await this.tryRedirectSignIn(A);if((!g||g===C)&&I?.user)Q=I.user,E=!0}if(!Q)return this.directlySetCurrentUser(null);if(!Q._redirectEventId){if(E)try{await this.beforeStateQueue.runMiddleware(Q)}catch(g){Q=B,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(g))}if(Q)return this.reloadAndSetCurrentUserOrClear(Q);else return this.directlySetCurrentUser(null)}if(Ig(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===Q._redirectEventId)return this.directlySetCurrentUser(Q);return this.reloadAndSetCurrentUserOrClear(Q)}async tryRedirectSignIn(A){let B=null;try{B=await this._popupRedirectResolver._completeRedirectFn(this,A,!0)}catch(Q){await this._setRedirectUser(null)}return B}async reloadAndSetCurrentUserOrClear(A){try{await xd(A)}catch(B){if(B?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(A)}useDeviceLanguage(){this.languageCode=_bQ()}async _delete(){this._deleted=!0}async updateCurrentUser(A){if(PJ(this.app))return Promise.reject(RO(this));let B=A?K4(A):null;if(B)Ig(B.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token");return this._updateCurrentUser(B&&B._clone(this))}async _updateCurrentUser(A,B=!1){if(this._deleted)return;if(A)Ig(this.tenantId===A.tenantId,this,"tenant-id-mismatch");if(!B)await this.beforeStateQueue.runMiddleware(A);return this.queue(async()=>{await this.directlySetCurrentUser(A),this.notifyAuthListeners()})}async signOut(){if(PJ(this.app))return Promise.reject(RO(this));if(await this.beforeStateQueue.runMiddleware(null),this.redirectPersistenceManager||this._popupRedirectResolver)await this._setRedirectUser(null);return this._updateCurrentUser(null,!0)}setPersistence(A){if(PJ(this.app))return Promise.reject(RO(this));return this.queue(async()=>{await this.assertedPersistence.setPersistence(OJ(A))})}_getRecaptchaConfig(){if(this.tenantId==null)return this._agentRecaptchaConfig;else return this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(A){if(!this._getPasswordPolicyInternal())await this._updatePasswordPolicy();let B=this._getPasswordPolicyInternal();if(B.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION)return Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{}));return B.validatePassword(A)}_getPasswordPolicyInternal(){if(this.tenantId===null)return this._projectPasswordPolicy;else return this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let A=await EdQ(this),B=new xRB(A);if(this.tenantId===null)this._projectPasswordPolicy=B;else this._tenantPasswordPolicies[this.tenantId]=B}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(A){this._errorFactory=new Rx("auth","Firebase",A())}onAuthStateChanged(A,B,Q){return this.registerStateListener(this.authStateSubscription,A,B,Q)}beforeAuthStateChanged(A,B){return this.beforeStateQueue.pushCallback(A,B)}onIdTokenChanged(A,B,Q){return this.registerStateListener(this.idTokenSubscription,A,B,Q)}authStateReady(){return new Promise((A,B)=>{if(this.currentUser)A();else{let Q=this.onAuthStateChanged(()=>{Q(),A()},B)}})}async revokeAccessToken(A){if(this.currentUser){let B=await this.currentUser.getIdToken(),Q={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:A,idToken:B};if(this.tenantId!=null)Q.tenantId=this.tenantId;await ebQ(this,Q)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(A,B){let Q=await this.getOrInitRedirectPersistenceManager(B);return A===null?Q.removeCurrentUser():Q.setCurrentUser(A)}async getOrInitRedirectPersistenceManager(A){if(!this.redirectPersistenceManager){let B=A&&OJ(A)||this._popupRedirectResolver;Ig(B,this,"argument-error"),this.redirectPersistenceManager=await YO.create(this,[OJ(B._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(A){if(this._isInitialized)await this.queue(async()=>{});if(this._currentUser?._redirectEventId===A)return this._currentUser;if(this.redirectUser?._redirectEventId===A)return this.redirectUser;return null}async _persistUserIfCurrent(A){if(A===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(A))}_notifyListenersIfCurrent(A){if(A===this.currentUser)this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){if(this.isProactiveRefreshEnabled=!0,this.currentUser)this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){if(this.isProactiveRefreshEnabled=!1,this.currentUser)this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let A=this.currentUser?.uid??null;if(this.lastNotifiedUid!==A)this.lastNotifiedUid=A,this.authStateSubscription.next(this.currentUser)}registerStateListener(A,B,Q,E){if(this._deleted)return()=>{};let g=typeof B==="function"?B:B.next.bind(B),C=!1,I=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ig(I,this,"internal-error"),I.then(()=>{if(C)return;g(this.currentUser)}),typeof B==="function"){let w=A.addObserver(B,Q,E);return()=>{C=!0,w()}}else{let w=A.addObserver(B);return()=>{C=!0,w()}}}async directlySetCurrentUser(A){if(this.currentUser&&this.currentUser!==A)this._currentUser._stopProactiveRefresh();if(A&&this.isProactiveRefreshEnabled)A._startProactiveRefresh();if(this.currentUser=A,A)await this.assertedPersistence.setCurrentUser(A);else await this.assertedPersistence.removeCurrentUser()}queue(A){return this.operations=this.operations.then(A,A),this.operations}get assertedPersistence(){return Ig(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(A){if(!A||this.frameworks.includes(A))return;this.frameworks.push(A),this.frameworks.sort(),this.clientVersion=DLA(this.config.clientPlatform,this._getFrameworks())}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let A={["X-Client-Version"]:this.clientVersion};if(this.app.options.appId)A["X-Firebase-gmpid"]=this.app.options.appId;let B=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();if(B)A["X-Firebase-Client"]=B;let Q=await this._getAppCheckToken();if(Q)A["X-Firebase-AppCheck"]=Q;return A}async _getAppCheckToken(){if(PJ(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let A=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();if(A?.error)sbQ(`Error while retrieving App Check token: ${A.error}`);return A?.token}}function JO(A){return K4(A)}class BLA{constructor(A){this.auth=A,this.observer=null,this.addObserver=cGB((B)=>this.observer=B)}get next(){return Ig(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function CdQ(A){return fRB.loadJS(A)}function IdQ(){return fRB.recaptchaEnterpriseScript}class cRB{constructor(){this.enterprise=new kRB}ready(A){A()}execute(A,B){return Promise.resolve("token")}render(A,B){return""}}class kRB{ready(A){A()}execute(A,B){return Promise.resolve("token")}render(A,B){return""}}class hRB{constructor(A){this.type=wdQ,this.auth=JO(A)}async verify(A="verify",B=!1){async function Q(g){if(!B){if(g.tenantId==null&&g._agentRecaptchaConfig!=null)return g._agentRecaptchaConfig.siteKey;if(g.tenantId!=null&&g._tenantRecaptchaConfigs[g.tenantId]!==void 0)return g._tenantRecaptchaConfigs[g.tenantId].siteKey}return new Promise(async(C,I)=>{$bQ(g,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((w)=>{if(w.recaptchaKey===void 0)I(Error("recaptcha Enterprise site key undefined"));else{let D=new MRB(w);if(g.tenantId==null)g._agentRecaptchaConfig=D;else g._tenantRecaptchaConfigs[g.tenantId]=D;return C(D.siteKey)}}).catch((w)=>{I(w)})})}function E(g,C,I){let w=window.grecaptcha;if(aGB(w))w.enterprise.ready(()=>{w.enterprise.execute(g,{action:A}).then((D)=>{C(D)}).catch(()=>{C(oRB)})});else I(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting)return new cRB().execute("siteKey",{action:"verify"});return new Promise((g,C)=>{Q(this.auth).then((I)=>{if(!B&&aGB(window.grecaptcha))E(I,g,C);else{if(typeof window>"u"){C(Error("RecaptchaVerifier is only supported in browser"));return}let w=IdQ();if(w.length!==0)w+=I;CdQ(w).then(()=>{E(I,g,C)}).catch((D)=>{C(D)})}}).catch((I)=>{C(I)})})}}async function o9(A,B,Q,E=!1,g=!1){let C=new hRB(A),I;if(g)I=oRB;else try{I=await C.verify(Q)}catch(D){I=await C.verify(Q,!0)}let w={...B};if(Q==="mfaSmsEnrollment"||Q==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in w){let D=w.phoneEnrollmentInfo.phoneNumber,H=w.phoneEnrollmentInfo.recaptchaToken;Object.assign(w,{phoneEnrollmentInfo:{phoneNumber:D,recaptchaToken:H,captchaResponse:I,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in w){let D=w.phoneSignInInfo.recaptchaToken;Object.assign(w,{phoneSignInInfo:{recaptchaToken:D,captchaResponse:I,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return w}if(!E)Object.assign(w,{captchaResponse:I});else Object.assign(w,{captchaResp:I});return Object.assign(w,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(w,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),w}async function nGB(A,B,Q,E,g){if(g==="EMAIL_PASSWORD_PROVIDER")if(A._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let C=await o9(A,B,Q,Q==="getOobCode");return E(A,C)}else return E(A,B).catch(async(C)=>{if(C.code==="auth/missing-recaptcha-token"){console.log(`${Q} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let I=await o9(A,B,Q,Q==="getOobCode");return E(A,I)}else return Promise.reject(C)});else if(g==="PHONE_PROVIDER")if(A._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let C=await o9(A,B,Q);return E(A,C).catch(async(I)=>{if(A._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"){if(I.code==="auth/missing-recaptcha-token"||I.code==="auth/invalid-app-credential"){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${Q} flow.`);let w=await o9(A,B,Q,!1,!0);return E(A,w)}}return Promise.reject(I)})}else{let C=await o9(A,B,Q,!1,!0);return E(A,C)}else return Promise.reject(g+" provider is not supported.")}function MLA(A,B){let Q=pFA(A,"auth");if(Q.isInitialized()){let g=Q.getImmediate(),C=Q.getOptions();if(Kx(C,B??{}))return g;else NJ(g,"already-initialized")}return Q.initialize({options:B})}function DdQ(A,B){let Q=B?.persistence||[],E=(Array.isArray(Q)?Q:[Q]).map(OJ);if(B?.errorMap)A._updateErrorMap(B.errorMap);A._initializeWithPersistence(E,B?.popupRedirectResolver)}function HLA(A,B,Q){let E=JO(A);Ig(/^https?:\/\//.test(B),E,"invalid-emulator-scheme");let g=!!Q?.disableWarnings,C=XRB(B),{host:I,port:w}=MdQ(B),D=w===null?"":`:${w}`,H={url:`${C}//${I}${D}/`},L=Object.freeze({host:I,port:w,protocol:C.replace(":",""),options:Object.freeze({disableWarnings:g})});if(!E._canInitEmulator){Ig(E.config.emulator&&E.emulatorConfig,E,"emulator-config-failed"),Ig(Kx(H,E.config.emulator)&&Kx(L,E.emulatorConfig),E,"emulator-config-failed");return}if(E.config.emulator=H,E.emulatorConfig=L,E.settings.appVerificationDisabledForTesting=!0,Y9(I))UGB(`${C}//${I}${D}`),GGB("Auth",!0);else if(!g)HdQ()}function XRB(A){let B=A.indexOf(":");return B<0?"":A.substr(0,B+1)}function MdQ(A){let B=XRB(A),Q=/(\/\/)?([^?#/]+)/.exec(A.substr(B.length));if(!Q)return{host:"",port:null};let E=Q[2].split("@").pop()||"",g=/^(\[[^\]]+\])(:|$)/.exec(E);if(g){let C=g[1];return{host:C,port:pGB(E.substr(C.length+1))}}else{let[C,I]=E.split(":");return{host:C,port:pGB(I)}}}function pGB(A){if(!A)return null;let B=Number(A);if(isNaN(B))return null;return B}function HdQ(){function A(){let B=document.createElement("p"),Q=B.style;B.innerText="Running in emulator mode. Do not use with production credentials.",Q.position="fixed",Q.width="100%",Q.backgroundColor="#ffffff",Q.border=".1em solid #000000",Q.color="#b50000",Q.bottom="0px",Q.left="0px",Q.margin="0px",Q.zIndex="10000",Q.textAlign="center",B.classList.add("firebase-emulator-warning"),document.body.appendChild(B)}if(typeof console<"u"&&typeof console.info==="function")console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");if(typeof window<"u"&&typeof document<"u")if(document.readyState==="loading")window.addEventListener("DOMContentLoaded",A);else A()}class SO{constructor(A,B){this.providerId=A,this.signInMethod=B}toJSON(){return lR("not implemented")}_getIdTokenResponse(A){return lR("not implemented")}_linkToIdToken(A,B){return lR("not implemented")}_getReauthenticationResolver(A){return lR("not implemented")}}async function FdQ(A,B){return gG(A,"POST","/v1/accounts:signUp",B)}async function LdQ(A,B){return T9(A,"POST","/v1/accounts:signInWithPassword",EG(A,B))}async function UdQ(A,B){return T9(A,"POST","/v1/accounts:signInWithEmailLink",EG(A,B))}async function GdQ(A,B){return T9(A,"POST","/v1/accounts:signInWithEmailLink",EG(A,B))}async function Kd(A,B){return T9(A,"POST","/v1/accounts:signInWithIdp",EG(A,B))}function KdQ(A){switch(A){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function YdQ(A){let B=R4(LO(A)).link,Q=B?R4(LO(B)).deep_link_id:null,E=R4(LO(A)).deep_link_id;return(E?R4(LO(E)).link:null)||E||Q||B||A}class y9{constructor(A){let B=R4(LO(A)),Q=B.apiKey??null,E=B.oobCode??null,g=KdQ(B.mode??null);Ig(Q&&E&&g,"argument-error"),this.apiKey=Q,this.operation=g,this.code=E,this.continueUrl=B.continueUrl??null,this.languageCode=B.lang??null,this.tenantId=B.tenantId??null}static parseLink(A){let B=YdQ(A);try{return new y9(B)}catch{return null}}}class x4{constructor(){this.providerId=x4.PROVIDER_ID}static credential(A,B){return S4._fromEmailAndPassword(A,B)}static credentialWithLink(A,B){let Q=y9.parseLink(B);return Ig(Q,"argument-error"),S4._fromEmailAndCode(A,Q.code,Q.tenantId)}}class FLA{constructor(A){this.providerId=A,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(A){this.defaultLanguageCode=A}setCustomParameters(A){return this.customParameters=A,this}getCustomParameters(){return this.customParameters}}class cd{constructor(A){this.user=A.user,this.providerId=A.providerId,this._tokenResponse=A._tokenResponse,this.operationType=A.operationType}static async _fromIdTokenResponse(A,B,Q,E=!1){let g=await OF._fromIdTokenResponse(A,Q,E),C=rGB(Q);return new cd({user:g,providerId:C,_tokenResponse:Q,operationType:B})}static async _forOperation(A,B,Q){await A._updateTokensIfNecessary(Q,!0);let E=rGB(Q);return new cd({user:A,providerId:E,_tokenResponse:Q,operationType:B})}}function rGB(A){if(A.providerId)return A.providerId;if("phoneNumber"in A)return"phone";return null}async function JdQ(A,B){return T9(A,"POST","/v1/accounts:signInWithCustomToken",EG(A,B))}async function hd(A,B){if(PJ(A.app))return Promise.reject(RO(A));let Q=JO(A),E=await JdQ(Q,{token:B,returnSecureToken:!0}),g=await cd._fromIdTokenResponse(Q,"signIn",E);return await Q._updateCurrentUser(g.user),g}function Xd(A,B,Q,E){return K4(A).onIdTokenChanged(B,Q,E)}function Pd(A){return K4(A).signOut()}function SdQ(A,B){return gG(A,"POST","/v2/accounts/mfaEnrollment:start",EG(A,B))}function xdQ(A,B){return gG(A,"POST","/v2/accounts/mfaEnrollment:finalize",EG(A,B))}class PRB{constructor(A){this.auth=A,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(A){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(A)}}addAuthTokenListener(A){if(this.assertAuthConfigured(),this.internalListeners.has(A))return;let B=this.auth.onIdTokenChanged((Q)=>{A(Q?.stsTokenManager.accessToken||null)});this.internalListeners.set(A,B),this.updateProactiveRefresh()}removeAuthTokenListener(A){this.assertAuthConfigured();let B=this.internalListeners.get(A);if(!B)return;this.internalListeners.delete(A),B(),this.updateProactiveRefresh()}assertAuthConfigured(){Ig(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){if(this.internalListeners.size>0)this.auth._startProactiveRefresh();else this.auth._stopProactiveRefresh()}}function fdQ(A){switch(A){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cdQ(A){UO(new hJ("auth",(B,{options:Q})=>{let E=B.getProvider("app").getImmediate(),g=B.getProvider("heartbeat"),C=B.getProvider("app-check-internal"),{apiKey:I,authDomain:w}=E.options;Ig(I&&!I.includes(":"),"invalid-api-key",{appName:E.name});let D={apiKey:I,authDomain:w,clientPlatform:A,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:DLA(A)},H=new od(E,g,C,D);return DdQ(H,Q),H},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((B,Q,E)=>{B.getProvider("auth-internal").initialize()})),UO(new hJ("auth-internal",(B)=>{let Q=JO(B.getProvider("auth").getImmediate());return((E)=>new PRB(E))(Q)},"PRIVATE").setInstantiationMode("EXPLICIT")),Jx(eGB,ARB,fdQ(A)),Jx(eGB,ARB,"esm2020")}function Od(A=sGB()){let B=pFA(A,"auth");if(B.isInitialized())return B.getImmediate();let Q=MLA(A),E=LGB("auth");if(E)HLA(Q,`http://${E}`);return Q}function kdQ(A,B){return gG(A,"POST","/v2/accounts/mfaSignIn:finalize",EG(A,B))}class ORB{constructor(A){this.factorId=A}_process(A,B,Q){switch(B.type){case"enroll":return this._finalizeEnroll(A,B.credential,Q);case"signin":return this._finalizeSignIn(A,B.credential);default:return lR("unexpected MultiFactorSessionType")}}}class Nd{static assertionForEnrollment(A,B){return O9._fromSecret(A,B)}static assertionForSignIn(A,B){return O9._fromEnrollmentId(A,B)}static async generateSecret(A){let B=A;Ig(typeof B.user?.auth<"u","internal-error");let Q=await SdQ(B.user.auth,{idToken:B.credential,totpEnrollmentInfo:{}});return V9._fromStartTotpMfaEnrollmentResponse(Q,B.user.auth)}}class V9{constructor(A,B,Q,E,g,C,I){this.sessionInfo=C,this.auth=I,this.secretKey=A,this.hashingAlgorithm=B,this.codeLength=Q,this.codeIntervalSeconds=E,this.enrollmentCompletionDeadline=g}static _fromStartTotpMfaEnrollmentResponse(A,B){return new V9(A.totpSessionInfo.sharedSecretKey,A.totpSessionInfo.hashingAlgorithm,A.totpSessionInfo.verificationCodeLength,A.totpSessionInfo.periodSec,new Date(A.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),A.totpSessionInfo.sessionInfo,B)}_makeTotpVerificationInfo(A){return{sessionInfo:this.sessionInfo,verificationCode:A}}generateQrCodeUrl(A,B){let Q=!1;if(Gd(A)||Gd(B))Q=!0;if(Q){if(Gd(A))A=this.auth.currentUser?.email||"unknownuser";if(Gd(B))B=this.auth.name}return`otpauth://totp/${B}:${A}?secret=${this.secretKey}&issuer=${B}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function Gd(A){return typeof A>"u"||A?.length===0}var QLA,QRB,Yd,tbQ,ubQ,abQ,$GB,fd,gdQ=6,fRB,wdQ="recaptcha-enterprise",oRB="NO_RECAPTCHA",S4,RdQ="http://localhost",TJ,xO,_R,tR,uR,aR,eGB="@firebase/auth",ARB="1.12.0",RlE,O9;

// === Module: Td (offset: 0xb70f7f, 9,958 chars) ===
var Td=z(()=>{GO();Y4();S9();f9();QLA=BRB,QRB=new Rx("auth","Firebase",BRB()),Yd=new x9("@firebase/auth");tbQ={["CREDENTIAL_MISMATCH"]:"custom-token-mismatch",["MISSING_CUSTOM_TOKEN"]:"internal-error",["INVALID_IDENTIFIER"]:"invalid-email",["MISSING_CONTINUE_URI"]:"internal-error",["INVALID_PASSWORD"]:"wrong-password",["MISSING_PASSWORD"]:"missing-password",["INVALID_LOGIN_CREDENTIALS"]:"invalid-credential",["EMAIL_EXISTS"]:"email-already-in-use",["PASSWORD_LOGIN_DISABLED"]:"operation-not-allowed",["INVALID_IDP_RESPONSE"]:"invalid-credential",["INVALID_PENDING_TOKEN"]:"invalid-credential",["FEDERATED_USER_ID_ALREADY_LINKED"]:"credential-already-in-use",["MISSING_REQ_TYPE"]:"internal-error",["EMAIL_NOT_FOUND"]:"user-not-found",["RESET_PASSWORD_EXCEED_LIMIT"]:"too-many-requests",["EXPIRED_OOB_CODE"]:"expired-action-code",["INVALID_OOB_CODE"]:"invalid-action-code",["MISSING_OOB_CODE"]:"internal-error",["CREDENTIAL_TOO_OLD_LOGIN_AGAIN"]:"requires-recent-login",["INVALID_ID_TOKEN"]:"invalid-user-token",["TOKEN_EXPIRED"]:"user-token-expired",["USER_NOT_FOUND"]:"user-token-expired",["TOO_MANY_ATTEMPTS_TRY_LATER"]:"too-many-requests",["PASSWORD_DOES_NOT_MEET_REQUIREMENTS"]:"password-does-not-meet-requirements",["INVALID_CODE"]:"invalid-verification-code",["INVALID_SESSION_INFO"]:"invalid-verification-id",["INVALID_TEMPORARY_PROOF"]:"invalid-credential",["MISSING_SESSION_INFO"]:"missing-verification-id",["SESSION_EXPIRED"]:"code-expired",["MISSING_ANDROID_PACKAGE_NAME"]:"missing-android-pkg-name",["UNAUTHORIZED_DOMAIN"]:"unauthorized-continue-uri",["INVALID_OAUTH_CLIENT_ID"]:"invalid-oauth-client-id",["ADMIN_ONLY_OPERATION"]:"admin-restricted-operation",["INVALID_MFA_PENDING_CREDENTIAL"]:"invalid-multi-factor-session",["MFA_ENROLLMENT_NOT_FOUND"]:"multi-factor-info-not-found",["MISSING_MFA_ENROLLMENT_ID"]:"missing-multi-factor-info",["MISSING_MFA_PENDING_CREDENTIAL"]:"missing-multi-factor-session",["SECOND_FACTOR_EXISTS"]:"second-factor-already-in-use",["SECOND_FACTOR_LIMIT_EXCEEDED"]:"maximum-second-factor-count-exceeded",["BLOCKING_FUNCTION_ERROR_RESPONSE"]:"internal-error",["RECAPTCHA_NOT_ENABLED"]:"recaptcha-not-enabled",["MISSING_RECAPTCHA_TOKEN"]:"missing-recaptcha-token",["INVALID_RECAPTCHA_TOKEN"]:"invalid-recaptcha-token",["INVALID_RECAPTCHA_ACTION"]:"invalid-recaptcha-action",["MISSING_CLIENT_TYPE"]:"missing-client-type",["MISSING_RECAPTCHA_VERSION"]:"missing-recaptcha-version",["INVALID_RECAPTCHA_VERSION"]:"invalid-recaptcha-version",["INVALID_REQ_TYPE"]:"invalid-req-type"},ubQ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],abQ=new gRB(30000,60000);$GB=new Map;ILA.type="NONE";fd=ILA;fRB={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};S4=class S4 extends SO{constructor(A,B,Q,E=null){super("password",Q);this._email=A,this._password=B,this._tenantId=E}static _fromEmailAndPassword(A,B){return new S4(A,B,"password")}static _fromEmailAndCode(A,B,Q=null){return new S4(A,B,"emailLink",Q)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(A){let B=typeof A==="string"?JSON.parse(A):A;if(B?.email&&B?.password){if(B.signInMethod==="password")return this._fromEmailAndPassword(B.email,B.password);else if(B.signInMethod==="emailLink")return this._fromEmailAndCode(B.email,B.password,B.tenantId)}return null}async _getIdTokenResponse(A){switch(this.signInMethod){case"password":let B={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nGB(A,B,"signInWithPassword",LdQ,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return UdQ(A,{email:this._email,oobCode:this._password});default:NJ(A,"internal-error")}}async _linkToIdToken(A,B){switch(this.signInMethod){case"password":let Q={idToken:B,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nGB(A,Q,"signUpPassword",FdQ,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return GdQ(A,{idToken:B,email:this._email,oobCode:this._password});default:NJ(A,"internal-error")}}_getReauthenticationResolver(A){return this._getIdTokenResponse(A)}};TJ=class TJ extends SO{constructor(){super(...arguments);this.pendingToken=null}static _fromParams(A){let B=new TJ(A.providerId,A.signInMethod);if(A.idToken||A.accessToken){if(A.idToken)B.idToken=A.idToken;if(A.accessToken)B.accessToken=A.accessToken;if(A.nonce&&!A.pendingToken)B.nonce=A.nonce;if(A.pendingToken)B.pendingToken=A.pendingToken}else if(A.oauthToken&&A.oauthTokenSecret)B.accessToken=A.oauthToken,B.secret=A.oauthTokenSecret;else NJ("argument-error");return B}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(A){let B=typeof A==="string"?JSON.parse(A):A,{providerId:Q,signInMethod:E,...g}=B;if(!Q||!E)return null;let C=new TJ(Q,E);return C.idToken=g.idToken||void 0,C.accessToken=g.accessToken||void 0,C.secret=g.secret,C.nonce=g.nonce,C.pendingToken=g.pendingToken||null,C}_getIdTokenResponse(A){let B=this.buildRequest();return Kd(A,B)}_linkToIdToken(A,B){let Q=this.buildRequest();return Q.idToken=B,Kd(A,Q)}_getReauthenticationResolver(A){let B=this.buildRequest();return B.autoCreate=!1,Kd(A,B)}buildRequest(){let A={requestUri:RdQ,returnSecureToken:!0};if(this.pendingToken)A.pendingToken=this.pendingToken;else{let B={};if(this.idToken)B.id_token=this.idToken;if(this.accessToken)B.access_token=this.accessToken;if(this.secret)B.oauth_token_secret=this.secret;if(B.providerId=this.providerId,this.nonce&&!this.pendingToken)B.nonce=this.nonce;A.postBody=J9(B)}return A}};x4.PROVIDER_ID="password";x4.EMAIL_PASSWORD_SIGN_IN_METHOD="password";x4.EMAIL_LINK_SIGN_IN_METHOD="emailLink";xO=class xO extends FLA{constructor(){super(...arguments);this.scopes=[]}addScope(A){if(!this.scopes.includes(A))this.scopes.push(A);return this}getScopes(){return[...this.scopes]}};_R=class _R extends xO{constructor(){super("facebook.com")}static credential(A){return TJ._fromParams({providerId:_R.PROVIDER_ID,signInMethod:_R.FACEBOOK_SIGN_IN_METHOD,accessToken:A})}static credentialFromResult(A){return _R.credentialFromTaggedObject(A)}static credentialFromError(A){return _R.credentialFromTaggedObject(A.customData||{})}static credentialFromTaggedObject({_tokenResponse:A}){if(!A||!("oauthAccessToken"in A))return null;if(!A.oauthAccessToken)return null;try{return _R.credential(A.oauthAccessToken)}catch{return null}}};_R.FACEBOOK_SIGN_IN_METHOD="facebook.com";_R.PROVIDER_ID="facebook.com";tR=class tR extends xO{constructor(){super("google.com");this.addScope("profile")}static credential(A,B){return TJ._fromParams({providerId:tR.PROVIDER_ID,signInMethod:tR.GOOGLE_SIGN_IN_METHOD,idToken:A,accessToken:B})}static credentialFromResult(A){return tR.credentialFromTaggedObject(A)}static credentialFromError(A){return tR.credentialFromTaggedObject(A.customData||{})}static credentialFromTaggedObject({_tokenResponse:A}){if(!A)return null;let{oauthIdToken:B,oauthAccessToken:Q}=A;if(!B&&!Q)return null;try{return tR.credential(B,Q)}catch{return null}}};tR.GOOGLE_SIGN_IN_METHOD="google.com";tR.PROVIDER_ID="google.com";uR=class uR extends xO{constructor(){super("github.com")}static credential(A){return TJ._fromParams({providerId:uR.PROVIDER_ID,signInMethod:uR.GITHUB_SIGN_IN_METHOD,accessToken:A})}static credentialFromResult(A){return uR.credentialFromTaggedObject(A)}static credentialFromError(A){return uR.credentialFromTaggedObject(A.customData||{})}static credentialFromTaggedObject({_tokenResponse:A}){if(!A||!("oauthAccessToken"in A))return null;if(!A.oauthAccessToken)return null;try{return uR.credential(A.oauthAccessToken)}catch{return null}}};uR.GITHUB_SIGN_IN_METHOD="github.com";uR.PROVIDER_ID="github.com";aR=class aR extends xO{constructor(){super("twitter.com")}static credential(A,B){return TJ._fromParams({providerId:aR.PROVIDER_ID,signInMethod:aR.TWITTER_SIGN_IN_METHOD,oauthToken:A,oauthTokenSecret:B})}static credentialFromResult(A){return aR.credentialFromTaggedObject(A)}static credentialFromError(A){return aR.credentialFromTaggedObject(A.customData||{})}static credentialFromTaggedObject({_tokenResponse:A}){if(!A)return null;let{oauthAccessToken:B,oauthTokenSecret:Q}=A;if(!B||!Q)return null;try{return aR.credential(B,Q)}catch{return null}}};aR.TWITTER_SIGN_IN_METHOD="twitter.com";aR.PROVIDER_ID="twitter.com";N9.initialize(fetch,Headers,Response);cdQ("Node");RlE=kd("operation-not-supported-in-this-environment");od.prototype.setPersistence=async()=>{};Nd.FACTOR_ID="totp";O9=class O9 extends ORB{constructor(A,B,Q){super("totp");this.otp=A,this.enrollmentId=B,this.secret=Q}static _fromSecret(A,B){return new O9(B,void 0,A)}static _fromEnrollmentId(A,B){return new O9(B,A)}async _finalizeEnroll(A,B,Q){return Ig(typeof this.secret<"u",A,"argument-error"),xdQ(A,{idToken:B,displayName:Q,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(A,B){Ig(this.enrollmentId!==void 0&&this.otp!==void 0,A,"argument-error");let Q={verificationCode:this.otp};return kdQ(A,{mfaPendingCredential:B,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:Q})}}});class LLA{constructor(A,B){this.storageRetriever=A,this.type=B}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(NRB,"1"),this.storage.removeItem(NRB),Promise.resolve(!0)}catch{return Promise.resolve(!1)}}_set(A,B){return this.storage.setItem(A,JSON.stringify(B)),Promise.resolve()}_get(A){let B=this.storage.getItem(A);return Promise.resolve(B?JSON.parse(B):null)}_remove(A){return this.storage.removeItem(A),Promise.resolve()}get storage(){return this.storageRetriever()}}var NRB="__sak",TRB,OlE,q7Q=1000,W7Q=10,yRB;

// === Module: ULA (offset: 0xb73f4c, 55 chars) ===
var ULA=z(()=>{ZRB()});var z7Q="firebase",j7Q="12.8.0";

// === Module: RLA (offset: 0xb73fbf, 1,540 chars) ===
var RLA=z(()=>{qRB();ULA();M4();GLA={apiKey:"AIzaSyDuNXvHd-GvTrmXG6_2TnrfqRWo-ApPd3s",authDomain:w4.firebaseAuthDomain,projectId:"embedder-dev",storageBucket:"embedder-dev.firebasestorage.app",messagingSenderId:"547074918538",appId:"1:547074918538:web:b5495d2347046fd29e8573"},v7Q=rFA(GLA),fO=Od(v7Q)});function yd(A){if(A instanceof Error)return A;if(typeof A==="string")return Error(A);if(A&&typeof A==="object"&&"message"in A)return Error(String(A.message));return Error(String(A))}function Vd(A,B){OI((Q)=>{if(Q.setTag("error_category","ai"),Q.setTag("ai_error_type",B.errorType),B.model)Q.setTag("model",B.model);if(B.provider)Q.setTag("provider",B.provider);if(B.sessionId)Q.setTag("session_id",B.sessionId);Q.setLevel("error"),Q.setContext("ai",B),jQ(yd(A))})}function WRB(A,B){OI((Q)=>{if(Q.setTag("error_category","api"),Q.setTag("api_endpoint",B.endpoint),Q.setTag("api_method",B.method),B.statusCode)Q.setTag("status_code",String(B.statusCode));let E=B.statusCode&&B.statusCode>=500?"error":"warning";Q.setLevel(E),Q.setContext("api",B),jQ(yd(A))})}function cO(A,B){OI((Q)=>{if(Q.setTag("error_category","operational"),Q.setTag("operation",B.operation),Q.setTag("component",B.component),Q.setLevel("error"),B.metadata)Q.setContext("metadata",B.metadata);jQ(yd(A))})}function zRB(A,B){OI((Q)=>{if(Q.setTag("error_category","tool"),Q.setTag("tool_name",B.toolName),B.toolCallId)Q.setTag("tool_call_id",B.toolCallId);Q.setLevel("error"),Q.setContext("tool",{toolName:B.toolName,toolCallId:B.toolCallId,params:B.params}),jQ(yd(A))})}

// === Module: oO (offset: 0xb747b3, 2,691 chars) ===
var oO=z(()=>{Z9=jRB(t7Q(),".embedder")});import{createCipheriv as a7Q,createDecipheriv as l7Q,createHash as $7Q,randomBytes as iRB,scryptSync as m7Q}from"crypto";import{existsSync as n7Q}from"fs";import{access as p7Q,mkdir as r7Q,unlink as e7Q}from"fs/promises";import{hostname as A_Q,userInfo as B_Q}from"os";async function JLA(A){try{await p7Q(A)}catch{await r7Q(A,{recursive:!0})}}async function SLA(A){try{let B=await Bun.file(A).text();return JSON.parse(B)}catch{return null}}async function xLA(A,B){await Bun.write(A,JSON.stringify(B,null,2))}function Q_Q(){if(kO(),n7Q(KLA))return new TextDecoder().decode(RB("fs").readFileSync(KLA));let A=iRB(32).toString("hex");return RB("fs").writeFileSync(KLA,A,{mode:384}),A}function E_Q(){let A=$7Q("sha256").update(`${A_Q()}-${B_Q().username}`).digest("hex"),B=Q_Q();return m7Q(A,B,32)}async function dRB(A){return Bun.file(A).exists()}async function W9(A){if(A===null){if(await dRB(q9))await e7Q(q9);return}await Zd();let B;if(A.authType==="better-auth")B=A;else B={...A,user:{...A.user,auth:{config:GLA}}};let Q=iRB(16),E=a7Q("aes-256-gcm",sRB,Q),g=Buffer.concat([E.update(JSON.stringify(B),"utf8"),E.final()]);await Bun.write(q9,Buffer.concat([Q,E.getAuthTag(),g]))}async function _RB(){if(!await dRB(q9))return null;try{let A=await Bun.file(q9).arrayBuffer(),B=Buffer.from(A),Q=B.subarray(0,16),E=B.subarray(16,32),g=B.subarray(32),C=l7Q("aes-256-gcm",sRB,Q);C.setAuthTag(E);let I=JSON.parse(Buffer.concat([C.update(g),C.final()]).toString()),w=D_Q.safeParse(I);if(w.success)return w.data;let D=w_Q.safeParse(I);if(D.success)return{authType:"firebase",...D.data};return fA.warn("Invalid credentials format",{error:w.error.message}),null}catch(A){return fA.warn("Failed to load credentials",{error:A}),null}}async function z9(A,B,Q){await Zd();let E={},g=Bun.file(qd);if(await g.exists())try{let C=await g.text();E=JSON.parse(C)}catch{E={}}E[A]={teamId:B,projectId:Q},await Bun.write(qd,JSON.stringify(E,null,2))}async function tRB(A){let B=Bun.file(qd);if(!await B.exists())return null;try{let Q=await B.text();return JSON.parse(Q)[A]||null}catch{return null}}async function uRB(A){let B=Bun.file(qd);if(!await B.exists())return null;try{let Q=await B.text(),E=JSON.parse(Q);for(let[g,C]of Object.entries(E))if(C.projectId===A)return g;return null}catch{return null}}async function fLA(A){await Zd();let B={},Q=Bun.file(YLA);if(await Q.exists())try{let E=await Q.text();B=JSON.parse(E)}catch{B={}}B[A]=Date.now(),await Bun.write(YLA,JSON.stringify(B,null,2))}async function aRB(){let A=Bun.file(YLA);if(!await A.exists())return{};try{let B=await A.text();return JSON.parse(B)}catch{return{}}}var q9,KLA,qd,YLA,sRB,bRB,g_Q,C_Q,I_Q,w_Q,D_Q;

// === Module: hO (offset: 0xb75236, 709 chars) ===
var hO=z(()=>{rC();M4();RLA();ZE();oO();q9=kL(`credentials-${vb}.enc`),KLA=kL(".salt"),qd=kL("workspace-cache.json"),YLA=kL("project-open.json");sRB=E_Q(),bRB=S.object({uid:S.string(),email:S.string().nullable().optional(),displayName:S.string().nullable().optional(),photoURL:S.string().nullable().optional(),emailVerified:S.boolean().optional()}).passthrough(),g_Q=S.object({authType:S.literal("firebase"),user:bRB,accessToken:S.string(),refreshToken:S.string()}),C_Q=S.object({id:S.string(),email:S.string(),name:S.string()}),I_Q=S.object({authType:S.literal("better-auth"),token:S.string(),user:C_Q}),w_Q=S.object({user:bRB,accessToken:S.string(),refreshToken:S.string()}),D_Q=S.union([g_Q,I_Q])});var j9;

// === Module: lRB (offset: 0xb754fb, 3,260 chars) ===
var lRB=z(()=>{j9=class j9 extends Error{status;statusText;body;parsedBody=null;constructor(A,B,Q){super(`${A} ${B}: ${Q}`);this.status=A;this.statusText=B;this.body=Q;this.name="ApiError";try{this.parsedBody=JSON.parse(Q)}catch{this.parsedBody=null}}get code(){return this.parsedBody?.code}get isUnauthorized(){return this.status===401||this.status===403}}});function M_Q(A){async function B(Q,E,g,C={}){let{headers:I={},maxRetries:w=2,auth:D="authenticated"}=C,H=!1,L;for(let R=0;R<=w;R++)try{let U={"Content-Type":"application/json","User-Agent":`embedder-cli/${vD}`};if(D!=="anonymous"&&A)if(A.type==="firebase"){let Y=await A.firebaseUser.getIdToken(H);U.Authorization=`Bearer ${Y}`}else U.Authorization=`Bearer ${A.token}`;if(vH&&OC.stagingToken)U["x-staging-token"]=OC.stagingToken;let G=await fetch(`${OC.apiUrl}/${E}`,{method:Q,headers:{...U,...I},body:g?JSON.stringify(g):void 0});if(!G.ok){let Y=await G.text();if(G.status===401||G.status===403)H=!0;throw new j9(G.status,G.statusText,Y)}return G.json()}catch(U){if(L=U instanceof Error?U:Error(String(U)),U instanceof j9)WRB(U,{endpoint:E,method:Q,statusCode:U.status});if(U instanceof j9&&U.isUnauthorized&&H)throw U;if(R<w)await new Promise((G)=>setTimeout(G,2**R*1000))}throw L}return{get:(Q,E)=>B("GET",Q,void 0,E),post:(Q,E,g)=>B("POST",Q,E,g),put:(Q,E,g)=>B("PUT",Q,E,g),delete:(Q,E)=>B("DELETE",Q,void 0,E)}}function mRB({children:A}){let[B,Q]=Sw.useState(!0),[E,g]=Sw.useState(null),[C,I]=Sw.useState(null),[w,D]=Sw.useState(null),H=Sw.useRef(null);Sw.useEffect(()=>{H.current=w},[w]),Sw.useEffect(()=>{let c=!1,h;return(async()=>{let T=await _RB();if(T?.authType==="better-auth"){if(c)return;D(T.token),g("better-auth"),Q(!1);return}if(T?.authType==="firebase")try{let k=OF._fromJSON(fO,T.user);await fO.updateCurrentUser(k)}catch(k){fA.warn("Failed to restore user from stored credentials",{error:k}),await W9(null)}if(c)return;h=Xd(fO,async(k)=>{if(k){try{let q=await k.getIdToken();await W9({authType:"firebase",user:k.toJSON(),accessToken:q,refreshToken:k.refreshToken}),fA.trace("Token stored/refreshed")}catch(q){fA.warn("Failed to store credentials",{error:q})}I(k),g("firebase")}else if(I(null),!H.current)g(null);Q(!1)})})(),()=>{c=!0,h?.()}},[]);let L=Sw.useCallback(async(c)=>{if(!c.accessToken)throw Error("No access token in response");if(c.authType==="better-auth"&&c.user){let h={authType:"better-auth",token:c.accessToken,user:c.user};await W9(h),D(c.accessToken),g("better-auth")}else await hd(fO,c.accessToken)},[]),R=Sw.useCallback(async()=>{await W9(null),D(null),g(null),I(null),await Pd(fO).catch(()=>{})},[]),U=Sw.useCallback(async()=>{if(H.current)return H.current;if(C)try{return await C.getIdToken()}catch{return null}return null},[C]),G=Sw.useMemo(()=>{if(E==="better-auth"&&w)return{type:"better-auth",token:w};if(E==="firebase"&&C)return{type:"firebase",firebaseUser:C};return null},[E,w,C]),Y=Sw.useMemo(()=>M_Q(G),[G]),J=Sw.useMemo(()=>({isAuthenticated:G!==null,isLoading:B,authType:E,firebaseUser:C,apiFetch:Y,getToken:U,login:L,logout:R}),[G,B,E,C,Y,U,L,R]);return O.jsxDEV($RB.Provider,{value:J,children:A},void 0,!1,void 0,this)}function Tg(){let A=Sw.useContext($RB);if(!A)throw Error("useAuth must be used within an AuthProvider");return A}var Sw,$RB;
